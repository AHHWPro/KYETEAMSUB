<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KYE BEEZY SERVER TEAM SUBMISSION</title>
  <meta name="description" content="Apply to join the KYE BEEZY Server Team." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    :root{
      --radius: 22px;
      --fade: 78%;
      --blob: 48vmin;

      --bg1:#0b0618;
      --bg2:#1a0f3a;
      --accent:#7c3aed;
      --glass:rgba(255,255,255,0.08);
      --glass-border:rgba(255,255,255,0.10);
    }

    html,body{height:100%}
    html, body { background-color: var(--bg2); overflow-x:hidden; color:#e5e7eb; }

    /* fixed full-screen background */
    #bg{
      position:fixed; inset:0; z-index:0; pointer-events:none;
      background:
        radial-gradient(140vmax 90vmax at 20% -10%, #1b1141 0%, rgba(27,17,65,0) var(--fade)),
        radial-gradient(120vmax 80vmax at 120% 0%, #2a175f 0%, rgba(42,23,95,0) var(--fade)),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      background-repeat:no-repeat;
      transform: translateZ(0);
    }

    #shade{
      position:fixed; inset:0; z-index:1; pointer-events:none;
      background:
        radial-gradient(140% 100% at 50% -20%, rgba(0,0,0,.34) 0%, rgba(0,0,0,0) var(--fade)),
        radial-gradient(120% 100% at 50% 120%, rgba(0,0,0,.34) 0%, rgba(0,0,0,0) var(--fade));
    }

    #blobs{
      position:fixed; inset:0; z-index:2; pointer-events:none; overflow:hidden;
    }
    .blob{
      position:absolute; width:var(--blob); height:var(--blob); border-radius:50%;
      background: radial-gradient(circle at 30% 30%, rgba(124,58,237,.35), rgba(124,58,237,.08) 60%, rgba(124,58,237,0) var(--fade));
      mix-blend-mode: screen;
      animation: float 16s ease-in-out infinite;
      filter: url(#goo);
    }
    .blob.b2{ width:calc(var(--blob)*0.88); height:calc(var(--blob)*0.88); left:70%; top:20%; animation-duration:18s; animation-delay:-4s}
    .blob.b3{ width:calc(var(--blob)*1.16); height:calc(var(--blob)*1.16); left:10%; top:60%; animation-duration:22s; animation-delay:-7s}
    @keyframes float{
      0%,100%{ transform: translateY(-20px) translateX(0) scale(1) }
      50%{ transform: translateY(20px) translateX(15px) scale(1.06) }
    }

    .glass{
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--glass-border);
      border-radius: var(--radius);
      backdrop-filter: blur(16px) saturate(120%);
      -webkit-backdrop-filter: blur(16px) saturate(120%);
      box-shadow:
        0 10px 30px rgba(0,0,0,.35),
        inset 0 1px 0 rgba(255,255,255,.08);
    }
    .glass-ring{ position:relative; overflow:hidden; border-radius: var(--radius); }
    .glass-ring::before{
      content:""; position:absolute; inset:-2px; border-radius: inherit;
      background: conic-gradient(from 180deg at 50% 50%, rgba(124,58,237,.0), rgba(124,58,237,.7), rgba(124,58,237,.0));
      filter: blur(14px); opacity:.55; pointer-events:none;
    }

    .btn{
      background: linear-gradient(180deg, #8b5cf6, #6d28d9);
      box-shadow: 0 10px 25px rgba(124,58,237,.35);
      border-radius: var(--radius);
    }
    .btn:hover{ filter:brightness(1.06) }

    .field{
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      transition: border-color .2s, box-shadow .2s;
      color:#e5e7eb;
    }
    .field:focus{
      outline: none;
      border-color: rgba(124,58,237,.7);
      box-shadow: 0 0 0 3px rgba(124,58,237,.25);
    }

    /* styled selects */
    select.field{
      appearance: none; -webkit-appearance:none; -moz-appearance:none;
      background-color: rgba(124,58,237,.14);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%23e5e7eb' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right .9rem center;
      padding-right: 2.5rem;
      border-color: rgba(124,58,237,.35);
      color:#e5e7eb;
    }
    select.field option{
      background-color:#2a175f;
      color:#e5e7eb;
    }
    select.field::-ms-expand{ display:none; }

    /* pretty file input */

    /* avatar upload styles */
    .filebox {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      position: relative;
    }
    
    .preview {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    .filebtn {
      background: linear-gradient(180deg, #8b5cf6, #6d28d9);
      padding: 0.5rem 1rem;
      border-radius: 12px;
      font-size: 0.875rem;
      font-weight: 500;
      color: #fff;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(124,58,237,.35);
      white-space: nowrap;
    }
    
    .filebtn:hover {
      filter: brightness(1.08);
    }
    
    /* 這裡關鍵：input 只覆蓋在按鈕內，不會整頁可點 */
    .filebtn input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }
    
    .filename {
      font-size: 0.875rem;
      color: #cbd5e1;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
      max-width: 180px;
    }
    



    
    .preview{
      width:40px; height:40px; border-radius:9999px; overflow:hidden;
      border:1px solid rgba(255,255,255,.15);
      background:#1f143f;
      display:flex; align-items:center; justify-content:center;
      flex:0 0 auto;
    }
    .preview img{ width:100%; height:100%; object-fit:cover; }
    .toast{ position:fixed; right:1rem; top:1rem; z-index:50 }
    .hp{ position:absolute; left:-10000px; top:auto; width:1px; height:1px; overflow:hidden }
  </style>
</head>
<body class="min-h-screen">
  <!-- filter defs -->
  <svg width="0" height="0" style="position:absolute">
    <defs>
      <filter id="goo">
        <feGaussianBlur in="SourceGraphic" stdDeviation="14" result="blur"/>
        <feColorMatrix in="blur" mode="matrix"
          values="1 0 0 0 0
                  0 1 0 0 0
                  0 0 1 0 0
                  0 0 0 25 -12" result="goo"/>
        <feBlend in="SourceGraphic" in2="goo"/>
      </filter>
    </defs>
  </svg>

  <!-- fixed layers -->
  <div id="bg" aria-hidden="true"></div>
  <div id="shade" aria-hidden="true"></div>
  <div id="blobs" aria-hidden="true">
    <div class="blob" style="left:-6%; top:-8%"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>
  </div>

  <header class="relative z-10 max-w-5xl mx-auto px-4 pt-10 pb-4">
    <div class="glass glass-ring p-4 md:p-5 flex items-center gap-3">
      <div class="p-2 rounded-xl bg-white/5 border border-white/10" style="border-radius: calc(var(--radius) - 6px);">
        <i data-lucide="shield-check" class="w-6 h-6"></i>
      </div>
      <div>
        <h1 class="text-2xl md:text-3xl font-bold tracking-tight">KYE BEEZY SERVER TEAM SUBMISSION</h1>
        <p class="text-sm md:text-base text-gray-300">Apply to join the team. Answer honestly and completely.</p>
      </div>
    </div>
  </header>

  <main class="relative z-10 max-w-5xl mx-auto px-4 pb-16">
    <div class="glass glass-ring p-6 md:p-10">
      <form id="appForm" class="grid grid-cols-1 md:grid-cols-2 gap-6 relative">
        <label class="hp">Do not fill<input type="text" name="website" autocomplete="off"></label>

        <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm mb-2">Discord Username (with @) <span class="text-red-400">*</span></label>
            <input required name="discord" placeholder="@yourname" class="field w-full px-4 py-3" />
          </div>
          <div>
            <label class="block text-sm mb-2">Time Zone (Location) <span class="text-red-400">*</span></label>
            <input required id="tz" name="timezone" placeholder="UTC+8 Asia/Taipei" class="field w-full px-4 py-3" />
          </div>
          <div>
            <label class="block text-sm mb-2">Gender</label>
            <input name="gender" placeholder="M / F / Other / Prefer not to say" class="field w-full px-4 py-3" />
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:col-span-2">
          <div>
            <label class="block text-sm mb-2">Age</label>
            <input type="number" min="10" max="120" name="age" placeholder="18" class="field w-full px-4 py-3" />
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm mb-2">Languages You Speak <span class="text-red-400">*</span></label>
            <input required name="languages" placeholder="English, Chinese, ..." class="field w-full px-4 py-3" />
          </div>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm mb-2">What skills or talents are you best at? <span class="text-red-400">*</span></label>
          <textarea required name="skills" rows="3" class="field w-full px-4 py-3" placeholder="e.g., moderation, design, video editing, coding, events, community..."></textarea>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm mb-2">Do you have previous team or server staff experience? If yes, describe it.</label>
          <textarea name="experience" rows="3" class="field w-full px-4 py-3" placeholder="What you did and the outcomes."></textarea>
        </div>

        <div>
          <label class="block text-sm mb-2">Which role or position are you most interested in? <span class="text-red-400">*</span></label>
          <input required name="role" class="field w-full px-4 py-3" placeholder="Moderator, Social, Designer, Editor, Dev, Host..." />
        </div>

        <div>
          <label class="block text-sm mb-2">Why do you want to join the KYE BEEZY Team? <span class="text-red-400">*</span></label>
          <input required name="why" class="field w-full px-4 py-3" placeholder="Your motivation and goals." />
        </div>

        <div>
          <label class="block text-sm mb-2">How active are you on Discord each day?</label>
          <input name="activity" class="field w-full px-4 py-3" placeholder="e.g., 2–4 hours, evenings." />
        </div>

        <div>
          <label class="block text-sm mb-2">How would you handle someone being rude or disrespectful in chat?</label>
          <input name="handleRude" class="field w-full px-4 py-3" placeholder="De-escalation approach." />
        </div>

        <div>
          <label class="block text-sm mb-2">How do you usually deal with conflict inside a team?</label>
          <input name="conflict" class="field w-full px-4 py-3" placeholder="Conflict-resolution method." />
        </div>

        <div>
          <label class="block text-sm mb-2">Are you comfortable joining a voice call for an interview? <span class="text-red-400">*</span></label>
          <select required name="vc" class="field w-full px-4 py-3">
            <option value="">Select</option>
            <option>Yes</option>
            <option>No</option>
          </select>
        </div>

        <div>
          <label class="block text-sm mb-2">Do you have a microphone and stable internet connection? <span class="text-red-400">*</span></label>
          <select required name="micNet" class="field w-full px-4 py-3">
            <option value="">Select</option>
            <option>Yes</option>
            <option>No</option>
          </select>
          <p class="text-xs text-gray-400 mt-1">Check: <a href="https://speedtest.net" target="_blank" class="underline">speedtest.net</a></p>
        </div>


        <!-- Avatar upload (pretty, fixed) -->
        <div class="md:col-span-2">
          <label class="block text-sm mb-2">Avatar (optional)</label>
          <div class="filebox flex items-center gap-3">
            <div class="preview" id="avatarPreview">
              <i data-lucide="image" class="w-5 h-5 opacity-70"></i>
            </div>
        
            <label class="filebtn relative overflow-hidden cursor-pointer">
              Choose file
              <input type="file" name="avatar" id="avatarInput" accept="image/*"
                     class="absolute inset-0 opacity-0 cursor-pointer">
            </label>
        
            <div class="filename">
              <span id="avatarName">No file selected</span>
            </div>
          </div>
          <p class="text-xs text-gray-400 mt-1">
            PNG/JPG/WebP ≤ 5 MB. Will appear in the Discord embed.
          </p>
        </div>


        <div class="md:col-span-2 flex items-center gap-3">
          <input id="agree" type="checkbox" required class="w-4 h-4" />
          <label for="agree" class="text-sm text-gray-300">I confirm all information is accurate. <span class="text-red-400">*</span></label>
        </div>

        <div class="md:col-span-2 flex flex-wrap items-center gap-3 pt-2">
          <button id="submitBtn" type="submit" class="btn inline-flex items-center gap-2 px-5 py-3">
            <i data-lucide="send" class="w-4 h-4"></i><span>Submit</span>
          </button>
          <button id="resetBtn" type="button" class="inline-flex items-center gap-2 px-5 py-3 bg-white/10 hover:bg-white/20 border border-white/10" style="border-radius: var(--radius);">
            <i data-lucide="rotate-ccw" class="w-4 h-4"></i><span>Reset</span>
          </button>
          <span class="text-xs text-gray-400">Local rate limit: 5 minutes.</span>
        </div>
      </form>
    </div>
  </main>

  <div id="toast" class="toast hidden">
    <div id="toastBox" class="glass px-4 py-3 text-sm"></div>
  </div>

  <footer class="relative z-10 max-w-5xl mx-auto px-4 pb-10 text-xs text-gray-400">
    <p>© <span id="year"></span> ARIES WU. All rights reserved.</p>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    window.addEventListener('load', () => { if (window.lucide) lucide.createIcons(); });

    const WEBHOOK = "https://discord.com/api/webhooks/1436316194507587647/EUiGxHpkKqhbKVwmInykJ_2J3gu4mgcgHlf2woUUBfjwvwgDdiaO8CbU5DpmTcpm4KQO";

    // ---- Auto timezone fill ----
    (function autoTimezone(){
      try{
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || "";
        const offsetMin = new Date().getTimezoneOffset(); // minutes west of UTC
        const sign = offsetMin <= 0 ? "+" : "-";
        const abs = Math.abs(offsetMin);
        const hh = String(Math.floor(abs/60)).padStart(2,"0");
        const mm = String(abs%60).padStart(2,"0");
        const s = `UTC${sign}${hh}:${mm} ${tz}`;
        const tzInput = document.getElementById('tz');
        if (tzInput && !tzInput.value) tzInput.value = s;
      }catch(_){}
    })();

    // ---- IP/Geo (optional; no key; CORS OK) ----
    let ipGeo = { ip:"Unavailable", city:"", region:"", country:"" };
    (async function fetchIp(){
      try{
        const r = await fetch("https://ipapi.co/json/");
        if (r.ok){
          const j = await r.json();
          ipGeo = {
            ip: j.ip || "Unavailable",
            city: j.city || "",
            region: j.region || "",
            country: j.country_name || (j.country || "")
          };
        }
      }catch(_){}
    })();

    // ---- Toast ----
    function toast(msg, ok=true){
      const t = document.getElementById('toast');
      const b = document.getElementById('toastBox');
      b.textContent = msg;
      b.className = "glass px-4 py-3 text-sm " + (ok ? "text-green-300" : "text-red-300");
      t.classList.remove('hidden');
      setTimeout(()=> t.classList.add('hidden'), 3600);
    }

    // ---- Rate limit ----
    function canSubmit(){
      const ts = Number(localStorage.getItem('kb_last_submit') || 0);
      return (Date.now() - ts) > 5*60*1000;
    }
    function markSubmit(){ localStorage.setItem('kb_last_submit', String(Date.now())); }

    // ---- Build Discord payload ----
    function buildEmbed(d, avatarFilename){
      const summary =
        `**Role:** ${d.role}\n`+
        `**Timezone:** ${d.timezone}\n`+
        `**Languages:** ${d.languages}\n`+
        `**Activity:** ${d.activity || "—"}`;

      const icon = avatarFilename ? `attachment://${avatarFilename}` : "https://cdn.discordapp.com/embed/avatars/1.png";

      const topInline = [
        { name: "Gender", value: d.gender || "—", inline: true },
        { name: "Age", value: d.age || "—", inline: true },
        { name: "VC Interview", value: d.vc, inline: true },
      ];

      const midInline = [
        { name: "Mic + Stable Net", value: d.micNet, inline: true },
        { name: "Handle Rude Chat", value: d.handleRude || "—", inline: true },
        { name: "Team Conflict", value: d.conflict || "—", inline: true },
      ];

      const full = [
        { name: "Skills / Talents", value: String(d.skills).slice(0,1024), inline: false },
        { name: "Experience", value: (d.experience || "—").slice(0,1024), inline: false },
        { name: "Why Join", value: String(d.why).slice(0,1024), inline: false },
        { name: "Anything Else", value: (d.extra || "—").slice(0,1024), inline: false },
      ];

      const locationLine = [ipGeo.ip, ipGeo.city, ipGeo.region, ipGeo.country].filter(Boolean).join(" • ");

      return {
        username: "KYE BEEZY Team Form",
        embeds: [{
          title: "New Team Application",
          description: summary,
          color: 0x7c3aed,
          timestamp: new Date().toISOString(),
          author: { name: d.discord, icon_url: icon },
          thumbnail: { url: icon },
          fields: [
            ...topInline,
            { name: "Timezone (Location)", value: d.timezone, inline: true },
            { name: "Preferred Role", value: d.role, inline: true },
            { name: "Daily Discord Activity", value: d.activity || "—", inline: true },
            { name: "Mic + Stable Net", value: d.micNet, inline: true },
            { name: "Handle Rude Chat", value: d.handleRude || "—", inline: true },
            { name: "Team Conflict", value: d.conflict || "—", inline: true },
            { name: "Network (IP / Geo)", value: locationLine || "Unavailable", inline: false },
            ...full
          ],
          footer: { text: "KYE BEEZY · Server Team", icon_url: icon }
        }]
      };
    }

    // ---- File input UX ----
    const avatarInput = document.getElementById('avatarInput');
    const avatarName = document.getElementById('avatarName');
    const avatarPreview = document.getElementById('avatarPreview');

    avatarInput.addEventListener('change', () => {
      const f = avatarInput.files?.[0];
      if (!f){
        avatarName.textContent = "No file selected";
        avatarPreview.innerHTML = '<i data-lucide="image" class="w-5 h-5 opacity-70"></i>';
        if (window.lucide) lucide.createIcons();
        return;
      }
      avatarName.textContent = f.name;
      // preview
      const url = URL.createObjectURL(f);
      avatarPreview.innerHTML = `<img alt="preview" src="${url}">`;
    });

    // ---- Form submit ----
    const form = document.getElementById('appForm');
    const resetBtn = document.getElementById('resetBtn');
    const submitBtn = document.getElementById('submitBtn');

    resetBtn.addEventListener('click', () => form.reset());

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (form.website && form.website.value) return;
      if (!canSubmit()){ toast("Please try again later. You can submit once every 5 minutes.", false); return; }

      submitBtn.disabled = true;
      submitBtn.classList.add('opacity-60','cursor-not-allowed');

      const fdForm = new FormData(form);
      const data = Object.fromEntries(fdForm.entries());
      const required = ["discord","timezone","languages","skills","role","why","vc","micNet"];
      for (const k of required){
        if(!data[k]){
          toast("Please complete all required fields.", false);
          submitBtn.disabled=false;
          submitBtn.classList.remove('opacity-60','cursor-not-allowed');
          return;
        }
      }

      // avatar file
      const avatarFile = avatarInput.files?.[0] || null;
      if (avatarFile && avatarFile.size > 5*1024*1024){
        toast("Avatar is larger than 5 MB.", false);
        submitBtn.disabled=false;
        submitBtn.classList.remove('opacity-60','cursor-not-allowed');
        return;
      }
      const avatarNameVal = avatarFile ? (avatarFile.name || "avatar.png") : null;

      // payload with attachment reference
      const payload = buildEmbed(data, avatarNameVal);

      // multipart body
      const fd = new FormData();
      fd.append("payload_json", JSON.stringify(payload));
      if (avatarFile) fd.append("files[0]", avatarFile, avatarNameVal);

      try{
        const res = await fetch(WEBHOOK, { method:"POST", body: fd });
        if(res.ok){
          markSubmit();
          form.reset();
          avatarName.textContent = "No file selected";
          avatarPreview.innerHTML = '<i data-lucide="image" class="w-5 h-5 opacity-70"></i>';
          if (window.lucide) lucide.createIcons();
          toast("Submitted. Thanks for your application.");
        }else{
          let msg = "";
          try { msg = await res.text(); } catch {}
          toast("Submission failed: " + res.status + " " + msg, false);
        }
      }catch(err){
        toast("Network blocked or failed: " + (err?.message || err), false);
      }finally{
        submitBtn.disabled = false;
        submitBtn.classList.remove('opacity-60','cursor-not-allowed');
      }
    });
  </script>
</body>
</html>
